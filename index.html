<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</title>

<!-- LIFF SDK -->
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;500;700&display=swap');

  :root{
    --bg:#0b0b0b;
    --card:#111111;
    --accent-start:#f6d365;
    --accent-end:#fda085;
  }
  body{
    margin:0;
    padding:40px 20px;
    min-height:100vh;
    box-sizing:border-box;
    background:var(--bg);
    color:#fff;
    font-family:'Prompt',sans-serif;
    -webkit-font-smoothing:antialiased;
    text-align:center;
  }

  h1{ margin: 0 0 8px; font-size:1.6rem; }
  p.lead{ margin:0 0 20px; color:#cfcfcf; }

  .card{
    width:100%;
    max-width:520px;
    margin: 0 auto;
    background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    border-radius:16px;
    padding:22px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.6);
    border: 1px solid rgba(255,255,255,0.03);
  }

  .share-btn{
    width:100%;
    max-width:420px;
    padding:14px 18px;
    margin-top:18px;
    border-radius:999px;
    border:none;
    font-weight:700;
    font-size:1.15rem;
    cursor:pointer;
    background: linear-gradient(135deg,var(--accent-start),var(--accent-end));
    color:#111;
    box-shadow: 0 6px 22px rgba(250,170,90,0.25);
  }

  .debug{
    margin-top:18px;
    text-align:left;
    font-size:0.88rem;
    color:#ddd;
    background: #070707;
    padding:10px;
    border-radius:8px;
    max-height:220px;
    overflow:auto;
    border:1px solid rgba(255,255,255,0.03);
  }

  .note{ margin-top:12px; font-size:0.85rem; color:#bdbdbd; }

  .small-btn {
    margin-top:10px;
    display:inline-block;
    padding:8px 12px;
    border-radius:10px;
    background:transparent;
    border:1px solid rgba(255,255,255,0.06);
    color:#fff;
    cursor:pointer;
    font-size:0.9rem;
  }
</style>
</head>
<body>
  <div class="card">
    <h1>‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</h1>
    <p class="lead">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏ô LINE</p>

    <button id="shareBtn" class="share-btn">üîÑ ‡πÅ‡∏ä‡∏£‡πå‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</button>

    <div class="note">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏ü‡∏£‡∏µ‡∏ô‡∏∞‡∏Ñ‡πà‡∏∞</div>

    <div style="display:flex;gap:8px;justify-content:center;">
      <button id="checkBtn" class="small-btn">‡πÄ‡∏ä‡πá‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ LIFF</button>
      <button id="showConsoleBtn" class="small-btn">‡∏•‡πâ‡∏≤‡∏á Debug</button>
    </div>

    <div id="debug" class="debug" aria-live="polite"></div>
  </div>

<script>
(async () => {
  const LIFF_ID = "2008637844-xtDvBoJq"; // <-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö LIFF ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
  const debugEl = document.getElementById('debug');
  const shareBtn = document.getElementById('shareBtn');
  const checkBtn = document.getElementById('checkBtn');
  const showConsoleBtn = document.getElementById('showConsoleBtn');

  function log(...args){
    console.log(...args);
    const t = args.map(a => {
      try { return typeof a === 'object' ? JSON.stringify(a,null,2) : String(a); }
      catch(e){ return String(a); }
    }).join(' ');
    const line = document.createElement('div');
    line.textContent = '[' + (new Date()).toLocaleTimeString() + '] ' + t;
    debugEl.prepend(line);
  }

  showConsoleBtn.addEventListener('click', () => { debugEl.innerHTML = ''; });

  // In-page check
  checkBtn.addEventListener('click', async () => {
    try {
      log('isInClient:', liff.isInClient());
      log('isLoggedIn:', liff.isLoggedIn());
      try {
        const ctx = await liff.getContext();
        log('getContext():', ctx);
      } catch(e) {
        log('getContext() error:', e && e.message ? e.message : e);
      }
      // NOTE: liff.permission.query may not be available in all envs; attempt safely
      try {
        if (liff.permission && liff.permission.query) {
          const perms = await liff.permission.query();
          log('permission.query():', perms);
        } else {
          log('permission.query() not available in this LIFF SDK.');
        }
      } catch(errPerm) {
        log('permission.query() error:', errPerm && errPerm.message ? errPerm.message : errPerm);
      }
    } catch(err) {
      log('Check error:', err && err.message ? err.message : err);
    }
  });

  // Initialize LIFF
  try {
    await liff.init({ liffId: LIFF_ID });
    log('liff.init OK');
  } catch(err) {
    log('liff.init failed:', err && err.message ? err.message : err);
  }

  // Share button click
  shareBtn.addEventListener('click', async () => {
    try {
      log('Share button clicked');
      if (!liff.isInClient()) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ LINE ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ä‡∏£‡πå (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô LINE App)');
        log('Not in LINE client - abort share');
        return;
      }

      // ‡∏ö‡∏¥‡∏•‡∏î‡πå Flex message ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡πÄ‡∏õ‡πá‡∏ô "message object"
      const flexMessage = {
        type: "flex",
        altText: "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏™‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©!",
        contents: {
          type: "bubble",
          hero: {
            type: "image",
            url: "https://img5.pic.in.th/file/secure-sv1/e881c03c-98c2-434f-b548-0494de3ce5fe.jpg",
            size: "full",
            aspectRatio: "1:1",
            aspectMode: "cover"
          },
          body: {
            type: "box",
            layout: "vertical",
            backgroundColor: "#111111", // ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á body
            contents: [
              { type: "text", text: "‡πÇ‡∏õ‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©!", weight: "bold", size: "xl", color: "#ffffff" },
              { type: "text", text: "‡∏Å‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå", size: "sm", color: "#cfcfcf", margin: "md" }
            ]
          },
          footer: {
            type: "box",
            layout: "vertical",
            spacing: "md",
            backgroundColor: "#111111", // ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á footer
            contents: [
              {
                type: "button",
                style: "primary",
                action: { type: "uri", label: "‡∏Å‡∏î‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå", uri: "https://lin.ee/lUCCivU" }
              },
              {
                type: "button",
                style: "link",
                action: { type: "uri", label: "‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", color: "#8b5dfd", uri: "https://lnwpg789.meauto.cloud/lnwpg789/betflix/register" }
              }
            ]
          }
        }
      };

      // ‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô "array ‡∏Ç‡∏≠‡∏á message objects" (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)
      log('Calling liff.shareTargetPicker with message object...');
      const result = await liff.shareTargetPicker([flexMessage]);

      // result === true ‡∏´‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏ö‡∏≤‡∏á‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô undefined)
      if (result === true || typeof result === 'object' || typeof result === 'undefined') {
        // ‡∏ö‡∏≤‡∏á SDK version ‡∏Ñ‡∏∑‡∏ô undefined ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏ä‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚Äî ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ console logs ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å
        log('shareTargetPicker result:', result);
        alert('‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß (‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡πà‡∏∞)');
      } else {
        log('shareTargetPicker canceled or failed:', result);
        alert('‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');
      }

    } catch (err) {
      log('share error:', err && err.message ? err.message : err);
      alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ç‡∏ì‡∏∞‡πÅ‡∏ä‡∏£‡πå ‚Äî ‡∏î‡∏π debug log ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö');
    }
  });

  // Initial quick logs
  try {
    log('isInClient (initial):', liff.isInClient());
    if (liff.isInClient()) {
      try { log('context:', await liff.getContext()); } catch(e){ log('getContext error:', e); }
    }
  } catch(e){
    log('Initial status error:', e);
  }

})();
</script>
</body>
</html>
